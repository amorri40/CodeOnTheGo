<table border="0" style="width:90%;">
 <tr>
   <td id="edit_cell1" >
   Editing
   </td>
   <td id="edit_cell2" >
   </td>
   <td id="edit_cell3" >
   </td>
  </tr>
   <tr>
   <td id="edit_cell4" >
   </td>
   <td id="edit_cell5" >
   </td>
   <td id="edit_cell6" >
   </td>
  </tr>
</table>

<script>
var classname=window._bubble_current.className;
if (classname==="cm-string") {load_edit_string();}
else if (classname==="cm-keyword") {load_edit_statement();}
else if (classname==="cm-comment") {load_edit_comment();}


function load_edit_string() {
	$('#edit_cell1')[0].innerHTML='<button type="button" onclick="edit_string();" style="width:45px; height:40px;">Edit Text</button>';
	$('#edit_cell2')[0].innerHTML='<button type="button" onclick="" style="width:90px; height:40px;">Change to expression</button>';
	$('#edit_cell3')[0].innerHTML='<button type="button" onclick="" style="width:45px; height:40px;">Split Text</button>';
	}

function load_edit_statement() {
	$('#edit_cell1')[0].innerHTML='<button type="button" onclick="" style="width:90px; height:35px;">change to..</button>';
	$('#edit_cell2')[0].innerHTML='<button type="button" onclick="remove_statement()" style="width:90px; height:35px;">Delete</button>';
	$('#edit_cell3')[0].innerHTML='<button type="button" onclick="edit_comment_out()" style="width:90px; height:35px;">Comment out</button>';
	$('#edit_cell4')[0].innerHTML='<button type="button" onclick="" style="width:90px; height:35px;">Copy</button>';
	$('#edit_cell5')[0].innerHTML='<select id="python_edit_statement_selection" style="width:90px;" onclick="$(window._bubble_current).goTo();" onChange="python_expression_action(this);"><option value="">Select</option><option value="">Add to Selection</option></select>';
	$('#edit_cell6')[0].innerHTML='<select id="python_edit_statement_spacing" style="width:90px;" onclick="$(window._bubble_current).goTo();" onChange="python_expression_action(this);"><option value="">Move Right</option><option value="">Move Left</option></select>';
	}	
	
function load_edit_comment() {
if (window._bubble_current.parentNode.tagName==="STATEMENT" && window._bubble_current.parentNode.getAttribute('commented')) 
		$('#edit_cell3')[0].innerHTML='<button type="button" class="bubblebutton" onclick="edit_uncomment_out()">UnComment out</button>';
else { //normal comment
		$('#edit_cell1')[0].innerHTML='<button type="button" class="bubblebutton" onclick="edit_comment_edit()">Edit</button>';
		$('#edit_cell2')[0].innerHTML='<button type="button" class="bubblebutton" onclick="edit_comment_delete()">Delete</button>';
	}
}
	
	
function edit_string() {
	var html = window._bubble_current.innerHTML;
	var newhtml =html.charAt(0);
	newhtml+=prompt('Editing: '+html, html.substring(1,html.length-1)) + html.charAt(html.length-1);
	window._bubble_current.innerHTML=newhtml;
}	

function remove_statement() {
	var el=window._bubble_current;
	goToPreviousElement();
	if (el.parentNode.tagName==="STATEMENT") el.parentNode.parentNode.removeChild(el.parentNode);
	//TODO and if for line statement
	}
	
/* 
Comment functions
*/
	
function edit_comment_out() {
   var el=window._bubble_current;
   var parent=el.parentNode;
   
   var code="";
   while (el!=null) {
   	code+=el.innerHTML;
	var next=el.nextSibling;
	el.style.display='none';
	el=next;
   }
   console.log(code);
  
    var span = createSpan('cm-comment','# '+code);
	parent.appendChild(span);
	parent.setAttribute('commented',true)
	goToNextElement();
}

function edit_uncomment_out() {
	var el=window._bubble_current.parentNode.firstChild;
    var parent=el.parentNode;
	
	goToNextElement();
	
	while (el!=null) {
		el.style.display='inline';
		el=el.nextSibling;
   }
   parent.removeChild(parent.getElementsByClassName('cm-comment')[0]);
   parent.setAttribute('commented',false)
}

/* End comment functions */
function edit_comment_edit() {
	var html = window._bubble_current.innerHTML;
	var newhtml =html.charAt(0); //new html will have #
	newhtml+=prompt('Editing: '+html, html.substring(1,html.length));
	window._bubble_current.innerHTML=newhtml; //change the html of the current element to the new comment
}

function edit_comment_delete() {
	delete_current();
}
</script>